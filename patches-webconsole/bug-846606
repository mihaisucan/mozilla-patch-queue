# HG changeset patch
# Parent af5f267cd6a1a1745b9d4393208b87e6d5892fda
# User Mihai Sucan <mihai.sucan@gmail.com>
# Date 1362773701 -7200

Bug 846606 - Intermittent browser_dbg_bug723069_editor-breakpoints.js | Test timed out | correct number of editor breakpoint changes - Got 3, expected 4; try: -b do -p linux,linux64,macosx64,win32,win64 -u mochitest-bc -t none

diff --git a/browser/devtools/debugger/test/browser_dbg_bug723069_editor-breakpoints.js b/browser/devtools/debugger/test/browser_dbg_bug723069_editor-breakpoints.js
--- a/browser/devtools/debugger/test/browser_dbg_bug723069_editor-breakpoints.js
+++ b/browser/devtools/debugger/test/browser_dbg_bug723069_editor-breakpoints.js
@@ -278,18 +278,22 @@ function test()
       info("rect " + iframe.contentDocument.documentElement.getBoundingClientRect());
 
       let utils = testWin.QueryInterface(Ci.nsIInterfaceRequestor)
                   .getInterface(Ci.nsIDOMWindowUtils);
 
       let rect = iframe.getBoundingClientRect();
       let left = rect.left + 10;
       let top = rect.top + 70;
-      utils.sendMouseEventToWindow("mousedown", left, top, 0, 1, 0, false, 0, 0);
-      utils.sendMouseEventToWindow("mouseup", left, top, 0, 1, 0, false, 0, 0);
+
+      waitForFocus(function() {
+        info("window focused");
+        utils.sendMouseEventToWindow("mousedown", left, top, 0, 1, 0, false, 0, 0);
+        utils.sendMouseEventToWindow("mouseup", left, top, 0, 1, 0, false, 0, 0);
+      }, iframe.contentWindow);
     });
 
   }
 
   function onEditorBreakpointRemoveSecond(aEvent)
   {
     gEditor.removeEventListener(SourceEditor.EVENTS.BREAKPOINT_CHANGE,
                                 onEditorBreakpointRemoveSecond);
